<mujoco model="cartpole-wheels-nofric">
    <!-- fast & stable defaults -->
    <option integrator="RK4" timestep="0.002"/>
    <compiler angle="degree" coordinate="local"/>
  
    <!-- no contact friction anywhere -->
    <default>
      <geom type="box" rgba="0.7 0.7 0.7 1" friction="0 0 0" solref="0.002 1" solimp="0.9 0.95 0.001"/>
      <joint damping="0" frictionloss="0"/>
      <motor gear="1"/>
    </default>
  
    <asset>
      <texture name="grid" type="2d" builtin="checker" width="512" height="512" rgb1="0.8 0.9 1" rgb2="0.7 0.8 0.9"/>
      <material name="mat" texture="grid" texrepeat="6 6" specular="0.3" shininess="0.5"/>
    </asset>
  
    <worldbody>
      <!-- ground just for visuals (friction is zero anyway) -->
      <geom name="floor" type="plane" size="50 50 1" material="mat" rgba="0.95 0.95 0.95 1"/>
  
      <!-- Cart: slides in x with zero damping/friction -->
      <body name="cart" pos="0 0 0.3">
        <joint name="slider" type="slide" axis="1 0 0" limited="false"/>
        <!-- cart chassis -->
        <geom name="cart_box" type="box" size="0.30 0.2 0.18" rgba="0.2 0.2 0.2 0.2" mass="0.5"/>
  
        <!-- Left wheel (visual + free-spinning hinge, no contact friction) -->
        <body name="wheel_L" pos="0 -0.25 -0.20">
          <joint name="wheel_L_hinge" type="hinge" axis="0 1 0"/>
          <!-- Cylinder axis is local z; rotate so z->y (wheel spins about y) -->
          <geom name="wheel_L_geom" type="cylinder" size="0.1 0.03" euler="-90 0 0" rgba="0.1 0.1 0.1 1" mass="0.05"/>
        </body>
  
        <!-- Right wheel -->
        <body name="wheel_R" pos="0 0.25 -0.2">
          <joint name="wheel_R_hinge" type="hinge" axis="0 1 0"/>
          <geom name="wheel_R_geom" type="cylinder" size="0.1 0.03" euler="-90 0 0" rgba="0.1 0.1 0.1 1" mass="0.05"/>
        </body>
  
        <!-- Pole: hinge about y so motion is in the x–z plane -->
        <!-- <body name="pole_base" pos="0 0 0.15"> -->
          <!-- <joint name="hinge" type="hinge" axis="0 1 0" limited="false"/> -->
          <!-- Comment: Capsule along local z by default: length = 2*fromto distance -->
          <!-- <geom name="pole" type="capsule" fromto="0 0 0  0 0 -0.22" size="0.02" rgba="0.9 0.2 0.2 1" mass="0.1"/> -->
        <!-- </body> -->
        <!-- Pole: hinge at base; mass concentrated at tip (classical cart-pole) -->
        <body name="pole_base" pos="0 0 0.08">
            <!-- Hinge so motion is in x–z plane -->
            <joint name="hinge" type="hinge" axis="0 -1 0" limited="false"/>
        
            <!-- Visual rod: nearly massless capsule (tiny mass to avoid singular inertia) -->
            <!-- length = 0.5 m; radius = 0.02 m -->
            <geom name="pole_rod" type="capsule"
                fromto="0 0 0  0 0 -0.2"
                size="0.01"
                rgba="0.9 0.2 0.2 1"
                mass="0.016"/>
        
            <!-- Tip body at z = 0.5 carrying (almost) all pole mass -->
            <body name="pole_tip" pos="0.0 0 -0.2">
            <!-- No joint here => rigidly follows the hinge above -->
            <!-- Sphere as point mass proxy; choose the total pole mass you want, e.g., 0.1 kg -->
            <geom name="pole_tip_mass" type="sphere" size="0.05" mass="0.3" rgba="0.9 0.2 0.2 1"/>
            </body>
        </body>
  


      </body>
      
    </worldbody>
  
    <actuator>
      <!-- Single input: horizontal force on cart -->
      <motor name="cart_force" joint="slider" ctrllimited="true" ctrlrange="-10 10"/>
    </actuator>
  
    <sensor>
      <jointpos name="x" joint="slider"/>
      <jointvel name="x_dot" joint="slider"/>
      <jointpos name="theta" joint="hinge"/>
      <jointvel name="theta_dot" joint="hinge"/>
    </sensor>
  </mujoco>
  